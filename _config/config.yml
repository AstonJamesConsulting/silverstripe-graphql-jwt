---
Name: firesphere-jwt-injections
After: "#coresecurity"
---
SilverStripe\Core\Injector\Injector:
  SilverStripe\Security\AuthenticationHandler:
    properties:
      Handlers:
        jwt: '%$Firesphere\GraphQLJWT\Authentication\JWTAuthenticationHandler'
  Firesphere\GraphQLJWT\Authentication\JWTAuthenticationHandler:
    properties:
      JWTAuthenticator: '%$Firesphere\GraphQLJWT\Authentication\JWTAuthenticator'
  SilverStripe\Security\Security:
    properties:
      Authenticators:
        default: '%$Firesphere\GraphQLJWT\Extensions\ExtendedMemberAuthenticator'
Firesphere\GraphQLJWT\Extensions\MemberExtension:
  requires_user_activation: true

---
Name: firesphere-jwt-middleware
After: "#session-manager-middleware"
---
SilverStripe\Core\Injector\Injector:
  SilverStripe\Control\Director:
    properties:
      Middlewares:
        LoginSessionMiddleware: '%$Firesphere\GraphQLJWT\Middleware\JWTLoginSessionMiddleware'

---
Name: custom-graphql-middlewares
After: 'graphql-middlewares'
---

SilverStripe\Core\Injector\Injector:
  SilverStripe\GraphQL\QueryHandler\QueryHandlerInterface:
    class: SilverStripe\GraphQL\QueryHandler\QueryHandler
    properties:
      Middlewares:
        csrf: false
        auth: '%$Firesphere\GraphQLJWT\Middleware\JWTGraphQLMiddleware'
